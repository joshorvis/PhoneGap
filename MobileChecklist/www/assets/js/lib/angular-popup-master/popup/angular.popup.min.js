/**!
 * artemdemo.popup 
 * version: 0.1.0
 * date: 2015-07-24
 * url: https://github.com/artemdemo/angular-popup
 * 
 */
!function(){var a=angular.module("artemdemo.popup",[]),b=function(a,b,c,d,e){var f,g,h,i={},j="closed",k=null,l={};l.backdrop=['<div class="popup-backdrop fadeIn"></div>'].join(""),l.popup=["<popup>","<form>",'<div class="popup-container" ng-class="POPUP_TYPE">','<div class="popup zoomIn">','<div class="popup-head">','<h3 class="popup-title ng-binding" ng-bind-html="TITLE"></h3>',"</div>",'<div class="popup-body">',"BODY_TXT","</div>",'<div class="popup-buttons"></div>',"</div>","</div>","</form>","</popup>"].join(""),l.buttons={},l.buttons.confirm=['<button ng-click="cancelAction($event)" class="btn btn-default cancel_button">{{ CANCEL_TXT }}</button>','<button ng-click="okAction($event)" class="btn btn-primary">{{ OK_TXT }}</button>'].join(""),l.buttons.show=['<button ng-click="okAction($event)" class="btn btn-ok" ng-class="okType || \'btn-block btn-primary\'">{{ OK_TXT }}</button>'].join(""),i.show=function(a){var b,d=a.hasOwnProperty("scope")?a.scope:void 0,e=a.hasOwnProperty("template")?a.template:"",h=c.defer();if("open"==j)return!1;j="open",a=angular.isObject(a)?a:{},b=m("show",e,d),f.TITLE=a.hasOwnProperty("title")?a.title:"",f.OK_TXT=a.hasOwnProperty("okText")?a.okText:"Ok",f.okType=a.hasOwnProperty("okType")?a.okType:"",f.CUSTOM_CLASS+=a.hasOwnProperty("popupClass")?" "+a.popupClass:"",document.getElementsByTagName("body")[0].classList.add("popup-open");for(var k=0;k<b.length;k++)document.body.appendChild(b[k]);return g.find("button")[0].focus(),f.okAction=function(){h.resolve(),document.getElementsByTagName("body")[0].classList.remove("popup-open"),i.hide()},h.promise},i.confirm=function(a){var b,e,h=a.hasOwnProperty("template")?a.template:"",l=a.hasOwnProperty("scope")?a.scope:void 0;if(k=c.defer(),"open"==j)return!1;j="open",a=angular.isObject(a)?a:{},b=m("confirm",h,l),f.TITLE=a.hasOwnProperty("title")?a.title:"",f.CANCEL_TXT=a.hasOwnProperty("cancelText")?a.cancelText:"Cancel",f.cancelType=a.hasOwnProperty("cancelType")?a.cancelType:"",f.OK_TXT=a.hasOwnProperty("okText")?a.okText:"Ok",f.okType=a.hasOwnProperty("okType")?a.okType:"",f.CUSTOM_CLASS+=a.hasOwnProperty("popupClass")?" "+a.popupClass:"",document.getElementsByTagName("body")[0].classList.add("popup-open");for(var n=0;n<b.length;n++)document.body.appendChild(b[n]);return f.cancelAction=function(){k.reject(),document.getElementsByTagName("body")[0].classList.remove("popup-open"),i.hide()},d(function(){e=g.find("input"),e.length>0?e[0].focus():g.find("button")[0].focus()}),f.okAction=function(b){var c=!1;c=a.hasOwnProperty("okTap")&&angular.isFunction(a.okTap)?a.okTap.call(f,b):!0,document.getElementsByTagName("body")[0].classList.remove("popup-open"),k.resolve(c),c&&i.hide()},k.promise},i.hide=function(a){var b=angular.element(g[0].getElementsByClassName("popup")[0]),c=angular.element(g[0].getElementsByClassName("popup-backdrop")[0]);f.$destroy(),j="closed",a?(g.remove(),clearTimeout(h)):(b.removeClass("zoomIn"),b.addClass("zoomOut"),c.removeClass("fadeIn"),c.addClass("fadeOut"),h=setTimeout(function(){g.remove()},200)),angular.element(document.getElementsByTagName("body")[0]).unbind("keyup"),angular.element(document.getElementsByTagName("body")[0]).removeClass("popup-open")};var m=function(c,d,e){var h,j,m,n,o;g&&i.hide(!0),m=l.popup.replace("BODY_TXT",d),g=angular.element(m),n=angular.element(l.backdrop),o=angular.element(l.buttons[c]),g.append(n);for(var p=0;p<o.length;p++)g[0].getElementsByClassName("popup-buttons")[0].appendChild(o[p]);return h=b(g),f=angular.isDefined(e)?e.$new():a.$new(),j=h(f),f.CUSTOM_CLASS="popup-type-"+c,angular.element(document.getElementsByTagName("body")[0]).bind("keyup",function(a){27==a.keyCode&&(k.reject(),i.hide())}),j};return i};a.factory("$popup",["$rootScope","$compile","$q","$timeout","$sce",b])}();